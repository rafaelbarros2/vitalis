    <div class="bg-slate-50 min-h-screen p-4 sm:p-8 flex items-center justify-center">
      <div class="w-full max-w-6xl">
        
        <div class="bg-white p-6 sm:p-8 rounded-xl shadow-md border border-slate-200">
          
          <!-- Cabeçalho com Título e Ação de Toggle -->
          <div class="flex flex-col sm:flex-row justify-between sm:items-center border-b border-slate-200 pb-4 mb-6">
            <div>
              <h1 class="text-2xl sm:text-3xl font-bold text-slate-800">Recepção</h1>
              <p class="text-slate-500 mt-1">Busque ou cadastre um novo paciente para iniciar.</p>
            </div>
            <button *ngIf="viewState() === 'busca'" (click)="setViewState('cadastro')" type="button" class="mt-4 sm:mt-0 w-full sm:w-auto px-5 py-2.5 text-white bg-blue-600 rounded-lg hover:bg-blue-700 font-semibold transition flex items-center justify-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" /></svg>
              Novo Paciente
            </button>
            <button *ngIf="viewState() === 'cadastro'" (click)="setViewState('busca')" type="button" class="mt-4 sm:mt-0 w-full sm:w-auto px-5 py-2.5 text-slate-700 bg-slate-100 rounded-lg hover:bg-slate-200 font-semibold transition flex items-center justify-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" /></svg>
              Buscar Paciente
            </button>
          </div>

          <!-- Seção de Busca de Paciente -->
          <div *ngIf="viewState() === 'busca'">
            <label for="search" class="block text-lg font-semibold text-slate-700 mb-2">Buscar Paciente</label>
            <div class="relative">
                <input type="text" id="search" name="search" class="w-full p-3 pl-10 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 transition" placeholder="Digite o Nome, CPF ou CNS...">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <svg class="h-5 w-5 text-slate-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" /></svg>
                </div>
            </div>
            <!-- Aqui entrariam os resultados da busca -->
            <div class="mt-4 text-center text-slate-400 p-4 border-2 border-dashed rounded-lg">
              <p>Nenhum paciente encontrado.</p>
            </div>
          </div>
          
          <!-- Formulário de Cadastro de Paciente -->
          <form *ngIf="viewState() === 'cadastro'" [formGroup]="cadastroForm" (ngSubmit)="onSubmit()" class="space-y-8">

            <!-- Seção: Dados Pessoais Básicos -->
            <div class="bg-slate-50 p-6 rounded-lg">
              <h3 class="text-lg font-semibold text-slate-800 mb-4">📋 Dados Pessoais Básicos</h3>
              <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div class="lg:col-span-2">
                  <label for="nome" class="block text-sm font-medium text-slate-600">Nome Completo *</label>
                  <input
                    type="text"
                    id="nome"
                    formControlName="nome"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('nome') ? 'border-red-500' : 'border-slate-300')">
                  <span *ngIf="isFieldInvalid('nome')" class="text-red-500 text-xs mt-1">{{ getFieldError('nome') }}</span>
                </div>
                <div>
                  <label for="nomeSocial" class="block text-sm font-medium text-slate-600">Nome Social</label>
                  <input type="text" id="nomeSocial" formControlName="nomeSocial" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="dataNascimento" class="block text-sm font-medium text-slate-600">Data de Nascimento *</label>
                  <input
                    type="date"
                    id="dataNascimento"
                    formControlName="dataNascimento"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('dataNascimento') ? 'border-red-500' : 'border-slate-300')">
                  <span *ngIf="isFieldInvalid('dataNascimento')" class="text-red-500 text-xs mt-1">{{ getFieldError('dataNascimento') }}</span>
                </div>
                <div>
                  <label for="sexo" class="block text-sm font-medium text-slate-600">Sexo Biológico *</label>
                  <select
                    id="sexo"
                    formControlName="sexo"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('sexo') ? 'border-red-500' : 'border-slate-300')">
                    <option value="">Selecione</option>
                    <option value="masculino">Masculino</option>
                    <option value="feminino">Feminino</option>
                    <option value="intersexo">Intersexo</option>
                    <option value="nao_informado">Não Informado</option>
                  </select>
                  <span *ngIf="isFieldInvalid('sexo')" class="text-red-500 text-xs mt-1">{{ getFieldError('sexo') }}</span>
                </div>
                <div>
                  <label for="identidadeGenero" class="block text-sm font-medium text-slate-600">Identidade de Gênero</label>
                  <select id="identidadeGenero" formControlName="identidadeGenero" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    <option value="">Selecione</option>
                    <option value="homem_cis">Homem Cisgênero</option>
                    <option value="mulher_cis">Mulher Cisgênero</option>
                    <option value="homem_trans">Homem Transgênero</option>
                    <option value="mulher_trans">Mulher Transgênero</option>
                    <option value="nao_binario">Não Binário</option>
                    <option value="outros">Outros</option>
                    <option value="nao_informado">Não Informado</option>
                  </select>
                </div>
                <div>
                  <label for="estadoCivil" class="block text-sm font-medium text-slate-600">Estado Civil *</label>
                  <select
                    id="estadoCivil"
                    formControlName="estadoCivil"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('estadoCivil') ? 'border-red-500' : 'border-slate-300')">
                    <option value="">Selecione</option>
                    <option value="solteiro">Solteiro(a)</option>
                    <option value="casado">Casado(a)</option>
                    <option value="divorciado">Divorciado(a)</option>
                    <option value="viuvo">Viúvo(a)</option>
                    <option value="uniao_estavel">União Estável</option>
                    <option value="separado">Separado(a)</option>
                  </select>
                  <span *ngIf="isFieldInvalid('estadoCivil')" class="text-red-500 text-xs mt-1">{{ getFieldError('estadoCivil') }}</span>
                </div>
                <div>
                  <label for="naturalidade" class="block text-sm font-medium text-slate-600">Naturalidade</label>
                  <input type="text" id="naturalidade" formControlName="naturalidade" placeholder="Cidade de nascimento" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="nacionalidade" class="block text-sm font-medium text-slate-600">Nacionalidade *</label>
                  <input
                    type="text"
                    id="nacionalidade"
                    formControlName="nacionalidade"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('nacionalidade') ? 'border-red-500' : 'border-slate-300')">
                  <span *ngIf="isFieldInvalid('nacionalidade')" class="text-red-500 text-xs mt-1">{{ getFieldError('nacionalidade') }}</span>
                </div>
                <div>
                  <label for="raca" class="block text-sm font-medium text-slate-600">Raça/Cor *</label>
                  <select
                    id="raca"
                    formControlName="raca"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('raca') ? 'border-red-500' : 'border-slate-300')">
                    <option value="">Selecione</option>
                    <option value="branca">Branca</option>
                    <option value="preta">Preta</option>
                    <option value="parda">Parda</option>
                    <option value="amarela">Amarela</option>
                    <option value="indigena">Indígena</option>
                    <option value="nao_declarado">Não Declarado</option>
                  </select>
                  <span *ngIf="isFieldInvalid('raca')" class="text-red-500 text-xs mt-1">{{ getFieldError('raca') }}</span>
                </div>
              </div>
            </div>

            <!-- Seção: Documentos de Identificação -->
            <div class="bg-slate-50 p-6 rounded-lg">
              <h3 class="text-lg font-semibold text-slate-800 mb-4">📄 Documentos de Identificação</h3>
              <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div>
                  <label for="cpf" class="block text-sm font-medium text-slate-600">CPF *</label>
                  <input
                    type="text"
                    id="cpf"
                    formControlName="cpf"
                    placeholder="000.000.000-00"
                    (input)="onCpfInput($event)"
                    maxlength="14"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('cpf') ? 'border-red-500' : 'border-slate-300')">
                  <span *ngIf="isFieldInvalid('cpf')" class="text-red-500 text-xs mt-1">{{ getFieldError('cpf') }}</span>
                </div>
                <div>
                  <label for="rg" class="block text-sm font-medium text-slate-600">RG</label>
                  <input type="text" id="rg" formControlName="rg" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="orgaoExpedidorRg" class="block text-sm font-medium text-slate-600">Órgão Expedidor RG</label>
                  <input type="text" id="orgaoExpedidorRg" formControlName="orgaoExpedidorRg" placeholder="Ex: SSP, DETRAN" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="ufExpedicaoRg" class="block text-sm font-medium text-slate-600">UF Expedição RG</label>
                  <select id="ufExpedicaoRg" formControlName="ufExpedicaoRg" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    <option value="">Selecione</option>
                    <option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option><option value="AM">AM</option>
                    <option value="BA">BA</option><option value="CE">CE</option><option value="DF">DF</option><option value="ES">ES</option>
                    <option value="GO">GO</option><option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option>
                    <option value="MG">MG</option><option value="PA">PA</option><option value="PB">PB</option><option value="PR">PR</option>
                    <option value="PE">PE</option><option value="PI">PI</option><option value="RJ">RJ</option><option value="RN">RN</option>
                    <option value="RS">RS</option><option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option>
                    <option value="SP">SP</option><option value="SE">SE</option><option value="TO">TO</option>
                  </select>
                </div>
                <div>
                  <label for="dataExpedicaoRg" class="block text-sm font-medium text-slate-600">Data Expedição RG</label>
                  <input type="date" id="dataExpedicaoRg" formControlName="dataExpedicaoRg" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="cns" class="block text-sm font-medium text-slate-600">Cartão Nacional de Saúde (CNS)</label>
                  <input type="text" id="cns" formControlName="cns" placeholder="000 0000 0000 0000" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="numeroPis" class="block text-sm font-medium text-slate-600">Número PIS/PASEP</label>
                  <input type="text" id="numeroPis" formControlName="numeroPis" placeholder="000.00000.00-0" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="tituloEleitor" class="block text-sm font-medium text-slate-600">Título de Eleitor</label>
                  <input type="text" id="tituloEleitor" formControlName="tituloEleitor" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="zonaEleitoral" class="block text-sm font-medium text-slate-600">Zona Eleitoral</label>
                  <input type="text" id="zonaEleitoral" formControlName="zonaEleitoral" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="secaoEleitoral" class="block text-sm font-medium text-slate-600">Seção Eleitoral</label>
                  <input type="text" id="secaoEleitoral" formControlName="secaoEleitoral" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="passaporte" class="block text-sm font-medium text-slate-600">Passaporte</label>
                  <input type="text" id="passaporte" formControlName="passaporte" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="validadePassaporte" class="block text-sm font-medium text-slate-600">Validade Passaporte</label>
                  <input type="date" id="validadePassaporte" formControlName="validadePassaporte" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="carteiraTrabalho" class="block text-sm font-medium text-slate-600">Carteira de Trabalho</label>
                  <input type="text" id="carteiraTrabalho" formControlName="carteiraTrabalho" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="serieCarteiraTrabalho" class="block text-sm font-medium text-slate-600">Série Carteira de Trabalho</label>
                  <input type="text" id="serieCarteiraTrabalho" formControlName="serieCarteiraTrabalho" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
              </div>
            </div>

            <!-- Seção: Dados Familiares e Responsáveis -->
            <div class="bg-slate-50 p-6 rounded-lg">
              <h3 class="text-lg font-semibold text-slate-800 mb-4">👨‍👩‍👧‍👦 Dados Familiares e Responsáveis</h3>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="nomeMae" class="block text-sm font-medium text-slate-600">Nome da Mãe</label>
                  <input type="text" id="nomeMae" formControlName="nomeMae" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="cpfMae" class="block text-sm font-medium text-slate-600">CPF da Mãe</label>
                  <input type="text" id="cpfMae" formControlName="cpfMae" placeholder="000.000.000-00" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="nomePai" class="block text-sm font-medium text-slate-600">Nome do Pai</label>
                  <input type="text" id="nomePai" formControlName="nomePai" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="cpfPai" class="block text-sm font-medium text-slate-600">CPF do Pai</label>
                  <input type="text" id="cpfPai" formControlName="cpfPai" placeholder="000.000.000-00" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="nomeResponsavel" class="block text-sm font-medium text-slate-600">Nome do Responsável Legal</label>
                  <input type="text" id="nomeResponsavel" formControlName="nomeResponsavel" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="cpfResponsavel" class="block text-sm font-medium text-slate-600">CPF do Responsável</label>
                  <input type="text" id="cpfResponsavel" formControlName="cpfResponsavel" placeholder="000.000.000-00" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="parentescoResponsavel" class="block text-sm font-medium text-slate-600">Parentesco do Responsável</label>
                  <input type="text" id="parentescoResponsavel" formControlName="parentescoResponsavel" placeholder="Ex: Tutor, Curador, etc." class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="telefoneResponsavel" class="block text-sm font-medium text-slate-600">Telefone do Responsável</label>
                  <input type="tel" id="telefoneResponsavel" formControlName="telefoneResponsavel" placeholder="(00) 00000-0000" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
              </div>
            </div>

            <!-- Seção: Contato e Comunicação -->
            <div class="bg-slate-50 p-6 rounded-lg">
              <h3 class="text-lg font-semibold text-slate-800 mb-4">📞 Informações de Contato e Comunicação</h3>
              <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div>
                  <label for="telefone" class="block text-sm font-medium text-slate-600">Telefone Principal *</label>
                  <input
                    type="tel"
                    id="telefone"
                    formControlName="telefone"
                    placeholder="(00) 00000-0000"
                    (input)="onPhoneInput($event, 'telefone')"
                    maxlength="15"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('telefone') ? 'border-red-500' : 'border-slate-300')">
                  <span *ngIf="isFieldInvalid('telefone')" class="text-red-500 text-xs mt-1">{{ getFieldError('telefone') }}</span>
                </div>
                <div>
                  <label for="telefoneRecado" class="block text-sm font-medium text-slate-600">Telefone para Recado</label>
                  <input type="tel" id="telefoneRecado" formControlName="telefoneRecado" placeholder="(00) 00000-0000" (input)="onPhoneInput($event, 'telefoneRecado')" maxlength="15" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="telefoneEmergencia" class="block text-sm font-medium text-slate-600">Telefone de Emergência</label>
                  <input type="tel" id="telefoneEmergencia" formControlName="telefoneEmergencia" placeholder="(00) 00000-0000" (input)="onPhoneInput($event, 'telefoneEmergencia')" maxlength="15" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="email" class="block text-sm font-medium text-slate-600">Email Principal</label>
                  <input
                    type="email"
                    id="email"
                    formControlName="email"
                    placeholder="email@exemplo.com"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('email') ? 'border-red-500' : 'border-slate-300')">
                  <span *ngIf="isFieldInvalid('email')" class="text-red-500 text-xs mt-1">{{ getFieldError('email') }}</span>
                </div>
                <div>
                  <label for="emailSecundario" class="block text-sm font-medium text-slate-600">Email Secundário</label>
                  <input
                    type="email"
                    id="emailSecundario"
                    formControlName="emailSecundario"
                    placeholder="email2@exemplo.com"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('emailSecundario') ? 'border-red-500' : 'border-slate-300')">
                  <span *ngIf="isFieldInvalid('emailSecundario')" class="text-red-500 text-xs mt-1">{{ getFieldError('emailSecundario') }}</span>
                </div>
                <div>
                  <label for="prefereContato" class="block text-sm font-medium text-slate-600">Prefere Contato Por *</label>
                  <select
                    id="prefereContato"
                    formControlName="prefereContato"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('prefereContato') ? 'border-red-500' : 'border-slate-300')">
                    <option value="telefone">Telefone</option>
                    <option value="email">Email</option>
                    <option value="whatsapp">WhatsApp</option>
                    <option value="sms">SMS</option>
                  </select>
                  <span *ngIf="isFieldInvalid('prefereContato')" class="text-red-500 text-xs mt-1">{{ getFieldError('prefereContato') }}</span>
                </div>
                <div class="flex items-center space-x-2">
                  <input type="checkbox" id="possuiWhatsapp" formControlName="possuiWhatsapp" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                  <label for="possuiWhatsapp" class="text-sm font-medium text-slate-600">Possui WhatsApp</label>
                </div>
                <div>
                  <label for="numeroWhatsapp" class="block text-sm font-medium text-slate-600">Número WhatsApp</label>
                  <input type="tel" id="numeroWhatsapp" formControlName="numeroWhatsapp" placeholder="(00) 00000-0000" (input)="onPhoneInput($event, 'numeroWhatsapp')" maxlength="15" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
              </div>
            </div>

            <!-- Seção: Endereço Residencial -->
            <div class="bg-slate-50 p-6 rounded-lg">
              <h3 class="text-lg font-semibold text-slate-800 mb-4">🏠 Endereço Residencial</h3>
              <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div>
                  <label for="cep" class="block text-sm font-medium text-slate-600">CEP *</label>
                  <input
                    type="text"
                    id="cep"
                    formControlName="cep"
                    placeholder="00000-000"
                    (input)="onCepInput($event)"
                    maxlength="9"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('cep') ? 'border-red-500' : 'border-slate-300')">
                  <span *ngIf="isFieldInvalid('cep')" class="text-red-500 text-xs mt-1">{{ getFieldError('cep') }}</span>
                </div>
                <div class="md:col-span-2">
                  <label for="endereco" class="block text-sm font-medium text-slate-600">Endereço *</label>
                  <input
                    type="text"
                    id="endereco"
                    formControlName="endereco"
                    placeholder="Rua, Avenida, etc."
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('endereco') ? 'border-red-500' : 'border-slate-300')">
                  <span *ngIf="isFieldInvalid('endereco')" class="text-red-500 text-xs mt-1">{{ getFieldError('endereco') }}</span>
                </div>
                <div>
                  <label for="numero" class="block text-sm font-medium text-slate-600">Número *</label>
                  <input
                    type="text"
                    id="numero"
                    formControlName="numero"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('numero') ? 'border-red-500' : 'border-slate-300')">
                  <span *ngIf="isFieldInvalid('numero')" class="text-red-500 text-xs mt-1">{{ getFieldError('numero') }}</span>
                </div>
                <div>
                  <label for="complemento" class="block text-sm font-medium text-slate-600">Complemento</label>
                  <input type="text" id="complemento" formControlName="complemento" placeholder="Apto, Casa, etc." class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="bairro" class="block text-sm font-medium text-slate-600">Bairro *</label>
                  <input
                    type="text"
                    id="bairro"
                    formControlName="bairro"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('bairro') ? 'border-red-500' : 'border-slate-300')">
                  <span *ngIf="isFieldInvalid('bairro')" class="text-red-500 text-xs mt-1">{{ getFieldError('bairro') }}</span>
                </div>
                <div>
                  <label for="cidade" class="block text-sm font-medium text-slate-600">Cidade *</label>
                  <input
                    type="text"
                    id="cidade"
                    formControlName="cidade"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('cidade') ? 'border-red-500' : 'border-slate-300')">
                  <span *ngIf="isFieldInvalid('cidade')" class="text-red-500 text-xs mt-1">{{ getFieldError('cidade') }}</span>
                </div>
                <div>
                  <label for="estado" class="block text-sm font-medium text-slate-600">Estado *</label>
                  <select
                    id="estado"
                    formControlName="estado"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('estado') ? 'border-red-500' : 'border-slate-300')">
                    <option value="">Selecione</option>
                    <option value="AC">Acre</option>
                    <option value="AL">Alagoas</option>
                    <option value="AP">Amapá</option>
                    <option value="AM">Amazonas</option>
                    <option value="BA">Bahia</option>
                    <option value="CE">Ceará</option>
                    <option value="DF">Distrito Federal</option>
                    <option value="ES">Espírito Santo</option>
                    <option value="GO">Goiás</option>
                    <option value="MA">Maranhão</option>
                    <option value="MT">Mato Grosso</option>
                    <option value="MS">Mato Grosso do Sul</option>
                    <option value="MG">Minas Gerais</option>
                    <option value="PA">Pará</option>
                    <option value="PB">Paraíba</option>
                    <option value="PR">Paraná</option>
                    <option value="PE">Pernambuco</option>
                    <option value="PI">Piauí</option>
                    <option value="RJ">Rio de Janeiro</option>
                    <option value="RN">Rio Grande do Norte</option>
                    <option value="RS">Rio Grande do Sul</option>
                    <option value="RO">Rondônia</option>
                    <option value="RR">Roraima</option>
                    <option value="SC">Santa Catarina</option>
                    <option value="SP">São Paulo</option>
                    <option value="SE">Sergipe</option>
                    <option value="TO">Tocantins</option>
                  </select>
                  <span *ngIf="isFieldInvalid('estado')" class="text-red-500 text-xs mt-1">{{ getFieldError('estado') }}</span>
                </div>
                <div>
                  <label for="pais" class="block text-sm font-medium text-slate-600">País *</label>
                  <input
                    type="text"
                    id="pais"
                    formControlName="pais"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('pais') ? 'border-red-500' : 'border-slate-300')">
                  <span *ngIf="isFieldInvalid('pais')" class="text-red-500 text-xs mt-1">{{ getFieldError('pais') }}</span>
                </div>
                <div>
                  <label for="pontoReferencia" class="block text-sm font-medium text-slate-600">Ponto de Referência</label>
                  <input type="text" id="pontoReferencia" formControlName="pontoReferencia" placeholder="Ex: Próximo ao supermercado" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="tipoResidencia" class="block text-sm font-medium text-slate-600">Tipo de Residência *</label>
                  <select
                    id="tipoResidencia"
                    formControlName="tipoResidencia"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('tipoResidencia') ? 'border-red-500' : 'border-slate-300')">
                    <option value="">Selecione</option>
                    <option value="propria">Própria</option>
                    <option value="alugada">Alugada</option>
                    <option value="financiada">Financiada</option>
                    <option value="cedida">Cedida</option>
                    <option value="outros">Outros</option>
                  </select>
                  <span *ngIf="isFieldInvalid('tipoResidencia')" class="text-red-500 text-xs mt-1">{{ getFieldError('tipoResidencia') }}</span>
                </div>
                <div>
                  <label for="tempoResidencia" class="block text-sm font-medium text-slate-600">Tempo de Residência</label>
                  <input type="text" id="tempoResidencia" formControlName="tempoResidencia" placeholder="Ex: 5 anos" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
              </div>
            </div>

            <!-- Seção: Dados Socioeconômicos -->
            <div class="bg-slate-50 p-6 rounded-lg">
              <h3 class="text-lg font-semibold text-slate-800 mb-4">💼 Dados Socioeconômicos e Profissionais</h3>
              <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div>
                  <label for="profissao" class="block text-sm font-medium text-slate-600">Profissão</label>
                  <input type="text" id="profissao" formControlName="profissao" placeholder="Ex: Professor, Médico" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="ocupacao" class="block text-sm font-medium text-slate-600">Ocupação Atual</label>
                  <input type="text" id="ocupacao" formControlName="ocupacao" placeholder="Função atual" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="situacaoTrabalhista" class="block text-sm font-medium text-slate-600">Situação Trabalhista *</label>
                  <select
                    id="situacaoTrabalhista"
                    formControlName="situacaoTrabalhista"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('situacaoTrabalhista') ? 'border-red-500' : 'border-slate-300')">
                    <option value="">Selecione</option>
                    <option value="empregado">Empregado</option>
                    <option value="desempregado">Desempregado</option>
                    <option value="autonomo">Autônomo</option>
                    <option value="aposentado">Aposentado</option>
                    <option value="pensionista">Pensionista</option>
                    <option value="estudante">Estudante</option>
                    <option value="do_lar">Do Lar</option>
                    <option value="outros">Outros</option>
                  </select>
                  <span *ngIf="isFieldInvalid('situacaoTrabalhista')" class="text-red-500 text-xs mt-1">{{ getFieldError('situacaoTrabalhista') }}</span>
                </div>
                <div>
                  <label for="rendaFamiliar" class="block text-sm font-medium text-slate-600">Renda Familiar</label>
                  <select id="rendaFamiliar" formControlName="rendaFamiliar" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    <option value="">Selecione</option>
                    <option value="ate_1_salario">Até 1 salário mínimo</option>
                    <option value="1_a_2_salarios">1 a 2 salários mínimos</option>
                    <option value="2_a_3_salarios">2 a 3 salários mínimos</option>
                    <option value="3_a_5_salarios">3 a 5 salários mínimos</option>
                    <option value="acima_5_salarios">Acima de 5 salários mínimos</option>
                    <option value="nao_informado">Não informado</option>
                  </select>
                </div>
                <div>
                  <label for="escolaridade" class="block text-sm font-medium text-slate-600">Escolaridade *</label>
                  <select
                    id="escolaridade"
                    formControlName="escolaridade"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('escolaridade') ? 'border-red-500' : 'border-slate-300')">
                    <option value="">Selecione</option>
                    <option value="nao_alfabetizado">Não Alfabetizado</option>
                    <option value="fundamental_incompleto">Fundamental Incompleto</option>
                    <option value="fundamental_completo">Fundamental Completo</option>
                    <option value="medio_incompleto">Médio Incompleto</option>
                    <option value="medio_completo">Médio Completo</option>
                    <option value="superior_incompleto">Superior Incompleto</option>
                    <option value="superior_completo">Superior Completo</option>
                    <option value="pos_graduacao">Pós-graduação</option>
                  </select>
                  <span *ngIf="isFieldInvalid('escolaridade')" class="text-red-500 text-xs mt-1">{{ getFieldError('escolaridade') }}</span>
                </div>
              </div>
            </div>

            <!-- Seção: Informações Médicas Detalhadas -->
            <div class="bg-slate-50 p-6 rounded-lg">
              <h3 class="text-lg font-semibold text-slate-800 mb-4">🏥 Informações Médicas Detalhadas</h3>
              <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div>
                  <label for="tipoSanguineo" class="block text-sm font-medium text-slate-600">Tipo Sanguíneo</label>
                  <select id="tipoSanguineo" formControlName="tipoSanguineo" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    <option value="">Selecione</option>
                    <option value="A+">A+</option>
                    <option value="A-">A-</option>
                    <option value="B+">B+</option>
                    <option value="B-">B-</option>
                    <option value="AB+">AB+</option>
                    <option value="AB-">AB-</option>
                    <option value="O+">O+</option>
                    <option value="O-">O-</option>
                    <option value="nao_informado">Não Informado</option>
                  </select>
                </div>
                <div>
                  <label for="peso" class="block text-sm font-medium text-slate-600">Peso (kg)</label>
                  <input type="number" id="peso" formControlName="peso" placeholder="70.5" step="0.1" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="altura" class="block text-sm font-medium text-slate-600">Altura (cm)</label>
                  <input type="number" id="altura" formControlName="altura" placeholder="175" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="doador" class="block text-sm font-medium text-slate-600">É Doador? *</label>
                  <select
                    id="doador"
                    formControlName="doador"
                    [class]="'mt-1 w-full p-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid('doador') ? 'border-red-500' : 'border-slate-300')">
                    <option value="nao_informado">Não Informado</option>
                    <option value="orgaos">Doador de Órgãos</option>
                    <option value="sangue">Doador de Sangue</option>
                    <option value="medula">Doador de Medula</option>
                    <option value="nao_doador">Não é Doador</option>
                  </select>
                  <span *ngIf="isFieldInvalid('doador')" class="text-red-500 text-xs mt-1">{{ getFieldError('doador') }}</span>
                </div>
                <div class="lg:col-span-2">
                  <label for="alergias" class="block text-sm font-medium text-slate-600">Alergias Ambientais</label>
                  <input type="text" id="alergias" formControlName="alergias" placeholder="Ex: Poeira, Pólen, Pelos de animais..." class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div class="lg:col-span-2">
                  <label for="alergiasMedicamentos" class="block text-sm font-medium text-slate-600">Alergias a Medicamentos</label>
                  <input type="text" id="alergiasMedicamentos" formControlName="alergiasMedicamentos" placeholder="Ex: Penicilina, Dipirona..." class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div class="lg:col-span-2">
                  <label for="medicamentosUso" class="block text-sm font-medium text-slate-600">Medicamentos em Uso</label>
                  <textarea id="medicamentosUso" formControlName="medicamentosUso" rows="2" placeholder="Liste os medicamentos que o paciente faz uso..." class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>
                <div class="lg:col-span-2">
                  <label for="condicoesMedicas" class="block text-sm font-medium text-slate-600">Condições Médicas</label>
                  <textarea id="condicoesMedicas" formControlName="condicoesMedicas" rows="2" placeholder="Diabetes, Hipertensão, etc..." class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>
                <div class="lg:col-span-2">
                  <label for="cirurgiasAnteriores" class="block text-sm font-medium text-slate-600">Cirurgias Anteriores</label>
                  <textarea id="cirurgiasAnteriores" formControlName="cirurgiasAnteriores" rows="2" placeholder="Descreva cirurgias realizadas..." class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>
                <div class="lg:col-span-2">
                  <label for="hospitalizacoesAnteriores" class="block text-sm font-medium text-slate-600">Hospitalizações Anteriores</label>
                  <textarea id="hospitalizacoesAnteriores" formControlName="hospitalizacoesAnteriores" rows="2" placeholder="Descreva hospitalizações anteriores..." class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>
                <div class="lg:col-span-2">
                  <label for="historicoFamiliar" class="block text-sm font-medium text-slate-600">Histórico Familiar</label>
                  <textarea id="historicoFamiliar" formControlName="historicoFamiliar" rows="2" placeholder="Doenças na família..." class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>
                <div class="lg:col-span-2">
                  <label for="deficiencias" class="block text-sm font-medium text-slate-600">Deficiências</label>
                  <textarea id="deficiencias" formControlName="deficiencias" rows="2" placeholder="Descreva deficiências físicas ou mentais..." class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>
              </div>
            </div>

            <!-- Seção: Contato de Emergência -->
            <div class="bg-slate-50 p-6 rounded-lg">
              <h3 class="text-lg font-semibold text-slate-800 mb-4">Contato de Emergência</h3>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="nomeEmergencia" class="block text-sm font-medium text-slate-600">Nome do Contato</label>
                  <input type="text" id="nomeEmergencia" formControlName="nomeEmergencia" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="parentescoEmergencia" class="block text-sm font-medium text-slate-600">Parentesco</label>
                  <input type="text" id="parentescoEmergencia" formControlName="parentescoEmergencia" placeholder="Ex: Cônjuge, Filho(a), Pai/Mãe" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
              </div>
            </div>

            <!-- Seção: Convênio/SUS -->
            <div class="bg-slate-50 p-6 rounded-lg">
              <h3 class="text-lg font-semibold text-slate-800 mb-4">Informações do Convênio/SUS</h3>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="convenio" class="block text-sm font-medium text-slate-600">Convênio</label>
                  <input type="text" id="convenio" formControlName="convenio" placeholder="Ex: SUS, Unimed, Amil..." class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                  <label for="numeroCarteirinha" class="block text-sm font-medium text-slate-600">Número da Carteirinha</label>
                  <input type="text" id="numeroCarteirinha" formControlName="numeroCarteirinha" class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
              </div>
            </div>

            <!-- Seção: Observações -->
            <div class="bg-slate-50 p-6 rounded-lg">
              <h3 class="text-lg font-semibold text-slate-800 mb-4">Observações Gerais</h3>
              <div>
                <label for="observacoes" class="block text-sm font-medium text-slate-600">Observações</label>
                <textarea id="observacoes" formControlName="observacoes" rows="3" placeholder="Informações adicionais relevantes..." class="mt-1 w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"></textarea>
              </div>
            </div>

            <!-- Ações do Formulário -->
            <div class="flex flex-col sm:flex-row justify-end items-center gap-4 pt-6 border-t border-slate-200">
              <button (click)="setViewState('busca')" type="button" class="w-full sm:w-auto px-6 py-2.5 text-slate-700 bg-slate-100 rounded-lg hover:bg-slate-200 font-semibold transition">
                Cancelar
              </button>
              <button type="submit" [disabled]="cadastroForm.invalid" [class]="'w-full sm:w-auto px-6 py-2.5 text-white rounded-lg font-semibold transition ' + (cadastroForm.invalid ? 'bg-slate-400 cursor-not-allowed' : 'bg-blue-600 hover:bg-blue-700')">
                Salvar e Iniciar Atendimento
              </button>
            </div>
          </form>

        </div>
      </div>
    </div>