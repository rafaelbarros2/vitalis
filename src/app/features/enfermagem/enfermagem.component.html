<div class="bg-slate-100 min-h-screen p-4 sm:p-8" style="color: #1f2937;">
      <div class="max-w-6xl mx-auto">
        
        <!-- Cabe√ßalho da P√°gina -->
        <div class="mb-6">
          <h1 class="text-3xl font-bold" style="color: #0f172a;">Posto de Enfermagem</h1>
          <p class="mt-1" style="color: #374151;">Pacientes aguardando procedimentos e em observa√ß√£o.</p>
        </div>

        <!-- Lista de Pacientes -->
        <div class="space-y-6">
          <!-- Card de Paciente (Exemplo 1) -->
          <div *ngFor="let paciente of pacientes()" class="bg-white p-5 rounded-xl shadow-md border border-slate-200 transition-all hover:shadow-lg">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              
              <!-- Informa√ß√µes do Paciente -->
              <div class="md:col-span-1 border-b md:border-b-0 md:border-r pb-4 md:pb-0 md:pr-4 border-slate-200">
                <h2 class="text-xl font-bold text-blue-600">{{ paciente.nome }}</h2>
                <p style="color: #374151;">Leito: {{ paciente.leito }}</p>
                <span class="mt-2 inline-block px-3 py-1 text-sm font-semibold rounded-full"
                  [ngClass]="paciente.status === 'Em Observa√ß√£o' ? 'bg-orange-100 text-orange-700' : 'bg-purple-100 text-purple-700'">
                  {{ paciente.status }}
                </span>
              </div>

              <!-- Prescri√ß√£o e Tarefas -->
              <div class="md:col-span-2">
                <h3 class="font-semibold mb-2" style="color: #374151;">Plano de Cuidados</h3>
                <div class="space-y-3">
                  <!-- Lista de Medicamentos -->
                  <div *ngFor="let med of paciente.prescricao.meds; let i = index">
                    <label class="flex items-center p-3 bg-slate-50 rounded-lg cursor-pointer hover:bg-slate-100">
                      <input type="checkbox" 
                             [checked]="med.administrada" 
                             (change)="toggleMedicacao(paciente.id, i)"
                             class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                      <span class="ml-3" [ngClass]="{'line-through': med.administrada}" style="color: #1f2937;">
                        {{ med.nome }} - <span class="text-sm font-mono">{{ med.dosagem }}</span>
                      </span>
                    </label>
                  </div>
                </div>
                <!-- Observa√ß√µes M√©dicas -->
                <div class="mt-4" *ngIf="paciente.prescricao.observacoes">
                  <p class="text-sm text-slate-800 bg-yellow-50 border border-yellow-200 p-3 rounded-md">
                    <span class="font-bold">Obs. M√©dica:</span> {{ paciente.prescricao.observacoes }}
                  </p>
                </div>
              </div>

            </div>
            <!-- A√ß√µes da Enfermagem -->
            <div class="flex justify-end gap-3 mt-4 pt-4 border-t border-slate-200">
                <button
                  (click)="abrirModalHistorico(paciente)"
                  class="px-4 py-2 text-sm font-semibold text-slate-700 bg-green-100 rounded-lg hover:bg-green-200 transition flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                  Ver Hist√≥rico
                </button>
                <button
                  (click)="abrirModalSinaisVitais(paciente)"
                  class="px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-100 rounded-lg hover:bg-slate-200 transition flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                  </svg>
                  Registrar Sinais Vitais
                </button>
                <button
                  (click)="abrirModalAnotacao(paciente)"
                  class="px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                  </svg>
                  Registrar Anota√ß√£o
                </button>
            </div>
          </div>
          
          <!-- Mensagem se n√£o houver pacientes -->
          <div *ngIf="pacientes().length === 0" class="text-center text-slate-400 p-8 border-2 border-dashed rounded-lg">
            <p>Nenhum paciente no posto de enfermagem no momento.</p>
          </div>

        </div>
      </div>

      <!-- Modal de Sinais Vitais -->
      <div *ngIf="modalAtivo() === 'sinais-vitais'" class="fixed inset-0 flex items-center justify-center z-50" (click)="fecharModal()">
        <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto" (click)="$event.stopPropagation()">
          <div class="p-6">
            <!-- Cabe√ßalho do Modal -->
            <div class="flex justify-between items-center border-b pb-4 mb-6">
              <div>
                <h2 class="text-2xl font-bold text-slate-900">üìä Registrar Sinais Vitais</h2>
                <p class="text-slate-800">Paciente: <span class="font-semibold">{{ pacienteSelecionado()?.nome }}</span> - Leito: {{ pacienteSelecionado()?.leito }}</p>
              </div>
              <button (click)="fecharModal()" class="text-slate-400 hover:text-slate-800 text-2xl">√ó</button>
            </div>

            <!-- Formul√°rio de Sinais Vitais -->
            <form [formGroup]="sinaisVitaisForm" (ngSubmit)="salvarSinaisVitais()" class="space-y-6">

              <!-- Sinais Vitais Principais -->
              <div class="bg-blue-50 p-6 rounded-lg">
                <h3 class="text-lg font-semibold text-blue-800 mb-4">Sinais Vitais Principais</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">

                  <!-- Press√£o Arterial -->
                  <div class="md:col-span-2 lg:col-span-1">
                    <label class="block text-sm font-medium text-slate-800 mb-2">Press√£o Arterial (mmHg)</label>
                    <div class="flex gap-2">
                      <div class="flex-1">
                        <input
                          type="number"
                          formControlName="pressaoArterialSistolica"
                          placeholder="Sist√≥lica"
                          [class]="'w-full p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid(sinaisVitaisForm, 'pressaoArterialSistolica') ? 'border-red-500' : 'border-slate-300')">
                      </div>
                      <span class="self-center text-slate-700">/</span>
                      <div class="flex-1">
                        <input
                          type="number"
                          formControlName="pressaoArterialDiastolica"
                          placeholder="Diast√≥lica"
                          [class]="'w-full p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid(sinaisVitaisForm, 'pressaoArterialDiastolica') ? 'border-red-500' : 'border-slate-300')">
                      </div>
                    </div>
                  </div>

                  <!-- Frequ√™ncia Card√≠aca -->
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">Frequ√™ncia Card√≠aca (bpm)</label>
                    <input
                      type="number"
                      formControlName="frequenciaCardiaca"
                      placeholder="Ex: 72"
                      [class]="'w-full p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid(sinaisVitaisForm, 'frequenciaCardiaca') ? 'border-red-500' : 'border-slate-300')">
                  </div>

                  <!-- Frequ√™ncia Respirat√≥ria -->
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">Frequ√™ncia Respirat√≥ria (rpm)</label>
                    <input
                      type="number"
                      formControlName="frequenciaRespiratoria"
                      placeholder="Ex: 20"
                      [class]="'w-full p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid(sinaisVitaisForm, 'frequenciaRespiratoria') ? 'border-red-500' : 'border-slate-300')">
                  </div>

                  <!-- Temperatura -->
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">Temperatura (¬∞C)</label>
                    <input
                      type="number"
                      step="0.1"
                      formControlName="temperatura"
                      placeholder="Ex: 36.5"
                      [class]="'w-full p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid(sinaisVitaisForm, 'temperatura') ? 'border-red-500' : 'border-slate-300')">
                  </div>

                  <!-- Satura√ß√£o de Oxig√™nio -->
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">Satura√ß√£o O‚ÇÇ (%)</label>
                    <input
                      type="number"
                      formControlName="saturacaoOxigenio"
                      placeholder="Ex: 98"
                      [class]="'w-full p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid(sinaisVitaisForm, 'saturacaoOxigenio') ? 'border-red-500' : 'border-slate-300')">
                  </div>

                  <!-- N√≠vel de Dor -->
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">N√≠vel de Dor (0-10)</label>
                    <input
                      type="number"
                      min="0"
                      max="10"
                      formControlName="nivelDor"
                      placeholder="0 = sem dor"
                      [class]="'w-full p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid(sinaisVitaisForm, 'nivelDor') ? 'border-red-500' : 'border-slate-300')">
                  </div>
                </div>
              </div>

              <!-- Dados Complementares -->
              <div class="bg-green-50 p-6 rounded-lg">
                <h3 class="text-lg font-semibold text-green-800 mb-4">Dados Complementares</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">Peso (kg)</label>
                    <input
                      type="number"
                      step="0.1"
                      formControlName="peso"
                      placeholder="Ex: 70.5"
                      class="w-full p-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">Altura (cm)</label>
                    <input
                      type="number"
                      formControlName="altura"
                      placeholder="Ex: 175"
                      class="w-full p-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">Glicemia (mg/dL)</label>
                    <input
                      type="number"
                      formControlName="glicemia"
                      placeholder="Ex: 90"
                      class="w-full p-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                  </div>
                </div>
              </div>

              <!-- Observa√ß√µes -->
              <div>
                <label class="block text-sm font-medium text-slate-800 mb-2">Observa√ß√µes</label>
                <textarea
                  formControlName="observacoes"
                  rows="3"
                  placeholder="Observa√ß√µes sobre o estado geral do paciente..."
                  class="w-full p-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500"></textarea>
              </div>

              <!-- Bot√µes de A√ß√£o -->
              <div class="flex justify-end gap-3 pt-4 border-t">
                <button
                  type="button"
                  (click)="fecharModal()"
                  class="px-6 py-2 text-slate-700 bg-slate-100 rounded-lg hover:bg-slate-200 transition">
                  Cancelar
                </button>
                <button
                  type="submit"
                  class="px-6 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition">
                  Salvar Sinais Vitais
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Modal de Anota√ß√£o de Enfermagem -->
      <div *ngIf="modalAtivo() === 'anotacao'" class="fixed inset-0 flex items-center justify-center z-50" (click)="fecharModal()">
        <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto" (click)="$event.stopPropagation()">
          <div class="p-6">
            <!-- Cabe√ßalho do Modal -->
            <div class="flex justify-between items-center border-b pb-4 mb-6">
              <div>
                <h2 class="text-2xl font-bold text-slate-800">üìù Anota√ß√£o de Enfermagem</h2>
                <p class="text-slate-800">Paciente: <span class="font-semibold">{{ pacienteSelecionado()?.nome }}</span> - Leito: {{ pacienteSelecionado()?.leito }}</p>
                <p class="text-sm text-amber-600 mt-1">‚öñÔ∏è Documento com valor legal - registre com clareza e objetividade</p>
              </div>
              <button (click)="fecharModal()" class="text-slate-400 hover:text-slate-800 text-2xl">√ó</button>
            </div>

            <!-- Formul√°rio de Anota√ß√£o -->
            <form [formGroup]="anotacaoForm" (ngSubmit)="salvarAnotacao()" class="space-y-6">

              <!-- Tipo de Anota√ß√£o -->
              <div class="bg-amber-50 p-6 rounded-lg">
                <h3 class="text-lg font-semibold text-amber-800 mb-4">Classifica√ß√£o da Anota√ß√£o</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">Tipo de Anota√ß√£o *</label>
                    <select
                      formControlName="tipoAnotacao"
                      [class]="'w-full p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid(anotacaoForm, 'tipoAnotacao') ? 'border-red-500' : 'border-slate-300')">
                      <option value="">Selecione o tipo</option>
                      <option value="cuidado">Cuidado de Enfermagem</option>
                      <option value="medicacao">Administra√ß√£o de Medica√ß√£o</option>
                      <option value="procedimento">Procedimento Realizado</option>
                      <option value="observacao">Observa√ß√£o Cl√≠nica</option>
                      <option value="intercorrencia">Intercorr√™ncia</option>
                      <option value="orientacao">Orienta√ß√£o ao Paciente</option>
                    </select>
                    <span *ngIf="isFieldInvalid(anotacaoForm, 'tipoAnotacao')" class="text-red-500 text-xs">{{ getFieldError(anotacaoForm, 'tipoAnotacao') }}</span>
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">Sistema Corporal</label>
                    <select formControlName="sistema" class="w-full p-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                      <option value="">Selecione (opcional)</option>
                      <option value="cardiovascular">Cardiovascular</option>
                      <option value="respiratorio">Respirat√≥rio</option>
                      <option value="neurologico">Neurol√≥gico</option>
                      <option value="gastrointestinal">Gastrointestinal</option>
                      <option value="geniturinario">Geniturin√°rio</option>
                      <option value="tegumentar">Tegumentar (Pele)</option>
                      <option value="musculoesqueletico">Musculoesquel√©tico</option>
                      <option value="outros">Outros</option>
                    </select>
                  </div>
                </div>
              </div>

              <!-- Descri√ß√£o Principal -->
              <div>
                <label class="block text-sm font-medium text-slate-800 mb-2">Descri√ß√£o da Anota√ß√£o *</label>
                <textarea
                  formControlName="descricao"
                  rows="4"
                  placeholder="Exemplo: '14:30 - Administrado Dipirona 1g, via Intravenosa (IV) no acesso venoso do bra√ßo esquerdo, conforme prescri√ß√£o m√©dica. Paciente refere melhora da dor.'"
                  [class]="'w-full p-3 border rounded-md focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid(anotacaoForm, 'descricao') ? 'border-red-500' : 'border-slate-300')"></textarea>
                <span *ngIf="isFieldInvalid(anotacaoForm, 'descricao')" class="text-red-500 text-xs">{{ getFieldError(anotacaoForm, 'descricao') }}</span>
                <p class="text-xs text-slate-700 mt-1">M√≠nimo 10 caracteres. Seja claro, objetivo e completo.</p>
              </div>

              <!-- Campos Espec√≠ficos para Medica√ß√£o -->
              <div *ngIf="anotacaoForm.get('tipoAnotacao')?.value === 'medicacao'" class="bg-purple-50 p-6 rounded-lg">
                <h3 class="text-lg font-semibold text-purple-800 mb-4">Detalhes da Medica√ß√£o</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">Medicamento</label>
                    <input
                      type="text"
                      formControlName="medicamento"
                      placeholder="Ex: Dipirona"
                      class="w-full p-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">Dose</label>
                    <input
                      type="text"
                      formControlName="dose"
                      placeholder="Ex: 1g"
                      class="w-full p-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">Via</label>
                    <select formControlName="via" class="w-full p-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                      <option value="">Selecione</option>
                      <option value="oral">Oral (VO)</option>
                      <option value="iv">Intravenosa (IV)</option>
                      <option value="im">Intramuscular (IM)</option>
                      <option value="sc">Subcut√¢nea (SC)</option>
                      <option value="inalatoria">Inalat√≥ria</option>
                      <option value="topica">T√≥pica</option>
                      <option value="outras">Outras</option>
                    </select>
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">Local</label>
                    <input
                      type="text"
                      formControlName="local"
                      placeholder="Ex: Bra√ßo esquerdo"
                      class="w-full p-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                  </div>
                </div>
                <div class="mt-4">
                  <label class="flex items-center">
                    <input type="checkbox" formControlName="prescricaoMedica" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                    <span class="ml-2 text-sm text-slate-800">Conforme prescri√ß√£o m√©dica</span>
                  </label>
                </div>
              </div>

              <!-- Campos Espec√≠ficos para Procedimento -->
              <div *ngIf="anotacaoForm.get('tipoAnotacao')?.value === 'procedimento'" class="bg-green-50 p-6 rounded-lg">
                <h3 class="text-lg font-semibold text-green-800 mb-4">Detalhes do Procedimento</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">Procedimento</label>
                    <input
                      type="text"
                      formControlName="procedimento"
                      placeholder="Ex: Curativo"
                      class="w-full p-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">Material Utilizado</label>
                    <input
                      type="text"
                      formControlName="material"
                      placeholder="Ex: Soro fisiol√≥gico, gaze"
                      class="w-full p-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">Resultado</label>
                    <input
                      type="text"
                      formControlName="resultado"
                      placeholder="Ex: Bom aspecto, sem infec√ß√£o"
                      class="w-full p-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                  </div>
                </div>
              </div>

              <!-- Responsabilidade Profissional -->
              <div class="bg-red-50 p-6 rounded-lg border border-red-200">
                <h3 class="text-lg font-semibold text-red-800 mb-4">Responsabilidade Profissional</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">Profissional Respons√°vel *</label>
                    <input
                      type="text"
                      formControlName="profissionalResponsavel"
                      [class]="'w-full p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid(anotacaoForm, 'profissionalResponsavel') ? 'border-red-500' : 'border-slate-300')">
                    <span *ngIf="isFieldInvalid(anotacaoForm, 'profissionalResponsavel')" class="text-red-500 text-xs">{{ getFieldError(anotacaoForm, 'profissionalResponsavel') }}</span>
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">COREN *</label>
                    <input
                      type="text"
                      formControlName="coren"
                      placeholder="Ex: 123456"
                      [class]="'w-full p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid(anotacaoForm, 'coren') ? 'border-red-500' : 'border-slate-300')">
                    <span *ngIf="isFieldInvalid(anotacaoForm, 'coren')" class="text-red-500 text-xs">{{ getFieldError(anotacaoForm, 'coren') }}</span>
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-slate-800 mb-2">Categoria *</label>
                    <select
                      formControlName="categoria"
                      [class]="'w-full p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 ' + (isFieldInvalid(anotacaoForm, 'categoria') ? 'border-red-500' : 'border-slate-300')">
                      <option value="enfermeiro">Enfermeiro(a)</option>
                      <option value="tecnico_enfermagem">T√©cnico(a) de Enfermagem</option>
                      <option value="auxiliar_enfermagem">Auxiliar de Enfermagem</option>
                    </select>
                  </div>
                </div>
              </div>

              <!-- Bot√µes de A√ß√£o -->
              <div class="flex justify-end gap-3 pt-4 border-t">
                <button
                  type="button"
                  (click)="fecharModal()"
                  class="px-6 py-2 text-slate-700 bg-slate-100 rounded-lg hover:bg-slate-200 transition">
                  Cancelar
                </button>
                <button
                  type="submit"
                  [disabled]="anotacaoForm.invalid"
                  [class]="'px-6 py-2 text-white rounded-lg transition ' + (anotacaoForm.invalid ? 'bg-slate-400 cursor-not-allowed' : 'bg-blue-600 hover:bg-blue-700')">
                  Registrar Anota√ß√£o
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Modal de Hist√≥rico -->
      <div *ngIf="modalAtivo() === 'historico'" class="fixed inset-0 flex items-center justify-center z-50" (click)="fecharModal()">
        <div class="bg-white rounded-xl shadow-2xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto" (click)="$event.stopPropagation()">
          <div class="p-6">
            <!-- Cabe√ßalho do Modal -->
            <div class="flex justify-between items-center border-b pb-4 mb-6">
              <div>
                <h2 class="text-2xl font-bold text-slate-800">üìã Hist√≥rico do Paciente</h2>
                <p class="text-slate-800">Paciente: <span class="font-semibold">{{ pacienteSelecionado()?.nome }}</span> - Leito: {{ pacienteSelecionado()?.leito }}</p>
              </div>
              <button (click)="fecharModal()" class="text-slate-400 hover:text-slate-800 text-2xl">√ó</button>
            </div>

            <!-- Tabs do Hist√≥rico -->
            <div class="mb-6">
              <div class="border-b border-gray-200">
                <nav class="-mb-px flex space-x-8">
                  <button
                    (click)="setActiveTab('sinais-vitais')"
                    [class]="'py-2 px-1 border-b-2 font-medium text-sm ' + (activeTab() === 'sinais-vitais' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300')">
                    Sinais Vitais ({{ obterHistoricoSinaisVitais(pacienteSelecionado()?.id || 0).length }})
                  </button>
                  <button
                    (click)="setActiveTab('anotacoes')"
                    [class]="'py-2 px-1 border-b-2 font-medium text-sm ' + (activeTab() === 'anotacoes' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300')">
                    Anota√ß√µes de Enfermagem ({{ obterHistoricoAnotacoes(pacienteSelecionado()?.id || 0).length }})
                  </button>
                </nav>
              </div>
            </div>

            <!-- Conte√∫do dos Tabs -->
            <div class="max-h-96 overflow-y-auto">

              <!-- Tab Sinais Vitais -->
              <div *ngIf="activeTab() === 'sinais-vitais'" class="space-y-4">
                <div *ngIf="obterHistoricoSinaisVitais(pacienteSelecionado()?.id || 0).length === 0" class="text-center text-slate-400 p-8">
                  <p>Nenhum registro de sinais vitais encontrado.</p>
                </div>
                <div *ngFor="let registro of obterHistoricoSinaisVitais(pacienteSelecionado()?.id || 0)"
                     class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                  <div class="flex justify-between items-start mb-3">
                    <h4 class="font-semibold text-blue-800">Sinais Vitais</h4>
                    <span class="text-sm text-slate-800">{{ formatarDataHora(registro.dataHora) }}</span>
                  </div>
                  <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 text-sm">
                    <div *ngIf="registro.pressaoArterialSistolica && registro.pressaoArterialDiastolica" class="bg-white p-2 rounded">
                      <span class="font-medium text-slate-800">PA:</span> {{ registro.pressaoArterialSistolica }}/{{ registro.pressaoArterialDiastolica }} mmHg
                    </div>
                    <div *ngIf="registro.frequenciaCardiaca" class="bg-white p-2 rounded">
                      <span class="font-medium text-slate-800">FC:</span> {{ registro.frequenciaCardiaca }} bpm
                    </div>
                    <div *ngIf="registro.frequenciaRespiratoria" class="bg-white p-2 rounded">
                      <span class="font-medium text-slate-800">FR:</span> {{ registro.frequenciaRespiratoria }} rpm
                    </div>
                    <div *ngIf="registro.temperatura" class="bg-white p-2 rounded">
                      <span class="font-medium text-slate-800">Temp:</span> {{ registro.temperatura }}¬∞C
                    </div>
                    <div *ngIf="registro.saturacaoOxigenio" class="bg-white p-2 rounded">
                      <span class="font-medium text-slate-800">SpO‚ÇÇ:</span> {{ registro.saturacaoOxigenio }}%
                    </div>
                    <div *ngIf="registro.nivelDor !== undefined && registro.nivelDor !== null" class="bg-white p-2 rounded">
                      <span class="font-medium text-slate-800">Dor:</span> {{ registro.nivelDor }}/10
                    </div>
                    <div *ngIf="registro.peso" class="bg-white p-2 rounded">
                      <span class="font-medium text-slate-800">Peso:</span> {{ registro.peso }} kg
                    </div>
                    <div *ngIf="registro.altura" class="bg-white p-2 rounded">
                      <span class="font-medium text-slate-800">Altura:</span> {{ registro.altura }} cm
                    </div>
                    <div *ngIf="registro.glicemia" class="bg-white p-2 rounded">
                      <span class="font-medium text-slate-800">Glicemia:</span> {{ registro.glicemia }} mg/dL
                    </div>
                  </div>
                  <div *ngIf="registro.observacoes" class="mt-3 p-2 bg-white rounded border-l-4 border-blue-500">
                    <span class="font-medium text-slate-800">Observa√ß√µes:</span> {{ registro.observacoes }}
                  </div>
                  <div class="mt-3 text-xs text-slate-700">
                    Respons√°vel: {{ registro.profissionalResponsavel }} - COREN: {{ registro.coren }}
                  </div>
                </div>
              </div>

              <!-- Tab Anota√ß√µes -->
              <div *ngIf="activeTab() === 'anotacoes'" class="space-y-4">
                <div *ngIf="obterHistoricoAnotacoes(pacienteSelecionado()?.id || 0).length === 0" class="text-center text-slate-400 p-8">
                  <p>Nenhuma anota√ß√£o de enfermagem encontrada.</p>
                </div>
                <div *ngFor="let anotacao of obterHistoricoAnotacoes(pacienteSelecionado()?.id || 0)"
                     class="bg-green-50 p-4 rounded-lg border border-green-200">
                  <div class="flex justify-between items-start mb-3">
                    <div class="flex items-center gap-2">
                      <h4 class="font-semibold text-green-800">{{ formatarTipoAnotacao(anotacao.tipoAnotacao) }}</h4>
                      <span *ngIf="anotacao.sistema" class="px-2 py-1 text-xs bg-green-200 text-green-700 rounded-full">
                        {{ formatarSistema(anotacao.sistema) }}
                      </span>
                    </div>
                    <span class="text-sm text-slate-800">{{ formatarDataHora(anotacao.dataHora) }}</span>
                  </div>

                  <div class="bg-white p-3 rounded border-l-4 border-green-500 mb-3">
                    <p class="text-slate-700">{{ anotacao.descricao }}</p>
                  </div>

                  <!-- Detalhes espec√≠ficos -->
                  <div *ngIf="anotacao.tipoAnotacao === 'medicacao' && (anotacao.medicamento || anotacao.dose || anotacao.via)"
                       class="grid grid-cols-2 md:grid-cols-4 gap-2 mb-3">
                    <div *ngIf="anotacao.medicamento" class="bg-white p-2 rounded text-sm">
                      <span class="font-medium text-slate-800">Medicamento:</span> {{ anotacao.medicamento }}
                    </div>
                    <div *ngIf="anotacao.dose" class="bg-white p-2 rounded text-sm">
                      <span class="font-medium text-slate-800">Dose:</span> {{ anotacao.dose }}
                    </div>
                    <div *ngIf="anotacao.via" class="bg-white p-2 rounded text-sm">
                      <span class="font-medium text-slate-800">Via:</span> {{ formatarVia(anotacao.via) }}
                    </div>
                    <div *ngIf="anotacao.local" class="bg-white p-2 rounded text-sm">
                      <span class="font-medium text-slate-800">Local:</span> {{ anotacao.local }}
                    </div>
                  </div>

                  <div *ngIf="anotacao.tipoAnotacao === 'procedimento' && (anotacao.procedimento || anotacao.material || anotacao.resultado)"
                       class="grid grid-cols-1 md:grid-cols-3 gap-2 mb-3">
                    <div *ngIf="anotacao.procedimento" class="bg-white p-2 rounded text-sm">
                      <span class="font-medium text-slate-800">Procedimento:</span> {{ anotacao.procedimento }}
                    </div>
                    <div *ngIf="anotacao.material" class="bg-white p-2 rounded text-sm">
                      <span class="font-medium text-slate-800">Material:</span> {{ anotacao.material }}
                    </div>
                    <div *ngIf="anotacao.resultado" class="bg-white p-2 rounded text-sm">
                      <span class="font-medium text-slate-800">Resultado:</span> {{ anotacao.resultado }}
                    </div>
                  </div>

                  <div class="flex justify-between items-center text-xs text-slate-700">
                    <span>{{ formatarCategoria(anotacao.categoria) }}: {{ anotacao.profissionalResponsavel }} - COREN: {{ anotacao.coren }}</span>
                    <span class="px-2 py-1 bg-green-200 text-green-700 rounded-full">{{ formatarStatus(anotacao.status) }}</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Bot√£o de Fechar -->
            <div class="flex justify-end pt-4 border-t mt-6">
              <button
                (click)="fecharModal()"
                class="px-6 py-2 text-slate-700 bg-slate-100 rounded-lg hover:bg-slate-200 transition">
                Fechar
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
